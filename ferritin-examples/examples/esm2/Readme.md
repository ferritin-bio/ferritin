# ESM2 Inference



## Examples

```sh
RUST_BACKTRACE=1 cargo run --example esm2
cargo run --example esm2 --features metal -- --model-id 8M --protein-string \
MAFSAEDVLKEYDRRRRMEALLLSLYYPNDRKLLDYKEWSPPRVQVECPKAPVEWNNPPSEKGLIVGHFSGIKYKGEKAQASEVDVNKMCCWVSKFKDAMRRYQGIQTCKIPGKVLSDLDAKIKAYNLTVEGVEGFVRYSRVTKQHVAAFLKELRHSKQYENVNLIHYILTDKRVDIQHLEKDLVKDFKALVESAHRMRQGHMINVKYILYQLLKKHGHGPDGPDILTVKTGSKGVLYDDSFRKIYTDLGWKFTPL

cargo run --example esm2 --features metal -- --model-id 8M --protein-string \
MAFSAEDVLKEYDRR\<mask\>RMEALLLSLYYPNDRKLLDYKEWSPPRVQVECPKAPVEWNNPPSEKGLIVGHFSGIKYKGEKAQASEVDVNKMCCWVSKFKDAMRRYQGIQTCKIPGKVLSDLDAKIKAYNLTVEGVEGFVRYSRVTKQHVAAFLKELRHSKQYENVNLIHYILTDKRVDIQHLEKDLVKDFKALVESAHRMRQGHMINVKYILYQLLKKHGHGPDGPDILTVKTGSKGVLYDDSFRKIYTDLGWKFTPL

```



## Model Shape

```
Loading the Model and Tokenizer.......
Name: esm.contact_head.regression.bias, Shape: [1]
Name: esm.contact_head.regression.weight, Shape: [1, 120]
Name: esm.embeddings.position_embeddings.weight, Shape: [1026, 320]
Name: esm.embeddings.position_ids, Shape: [1, 1026]
Name: esm.embeddings.word_embeddings.weight, Shape: [33, 320]
Name: esm.encoder.emb_layer_norm_after.bias, Shape: [320]
Name: esm.encoder.emb_layer_norm_after.weight, Shape: [320]
Name: esm.encoder.layer.0.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.0.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.0.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.0.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.0.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.0.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.0.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.0.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.0.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.0.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.0.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.0.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.0.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.0.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.0.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.0.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.0.output.dense.weight, Shape: [320, 1280]
Name: esm.encoder.layer.1.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.1.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.1.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.1.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.1.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.1.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.1.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.1.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.1.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.1.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.1.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.1.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.1.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.1.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.1.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.1.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.1.output.dense.weight, Shape: [320, 1280]
Name: esm.encoder.layer.2.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.2.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.2.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.2.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.2.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.2.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.2.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.2.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.2.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.2.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.2.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.2.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.2.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.2.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.2.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.2.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.2.output.dense.weight, Shape: [320, 1280]
Name: esm.encoder.layer.3.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.3.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.3.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.3.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.3.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.3.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.3.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.3.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.3.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.3.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.3.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.3.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.3.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.3.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.3.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.3.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.3.output.dense.weight, Shape: [320, 1280]
Name: esm.encoder.layer.4.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.4.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.4.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.4.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.4.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.4.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.4.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.4.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.4.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.4.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.4.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.4.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.4.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.4.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.4.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.4.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.4.output.dense.weight, Shape: [320, 1280]
Name: esm.encoder.layer.5.attention.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.5.attention.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.5.attention.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.5.attention.output.dense.weight, Shape: [320, 320]
Name: esm.encoder.layer.5.attention.self.key.bias, Shape: [320]
Name: esm.encoder.layer.5.attention.self.key.weight, Shape: [320, 320]
Name: esm.encoder.layer.5.attention.self.query.bias, Shape: [320]
Name: esm.encoder.layer.5.attention.self.query.weight, Shape: [320, 320]
Name: esm.encoder.layer.5.attention.self.rotary_embeddings.inv_freq, Shape: [8]
Name: esm.encoder.layer.5.attention.self.value.bias, Shape: [320]
Name: esm.encoder.layer.5.attention.self.value.weight, Shape: [320, 320]
Name: esm.encoder.layer.5.intermediate.dense.bias, Shape: [1280]
Name: esm.encoder.layer.5.intermediate.dense.weight, Shape: [1280, 320]
Name: esm.encoder.layer.5.LayerNorm.bias, Shape: [320]
Name: esm.encoder.layer.5.LayerNorm.weight, Shape: [320]
Name: esm.encoder.layer.5.output.dense.bias, Shape: [320]
Name: esm.encoder.layer.5.output.dense.weight, Shape: [320, 1280]
Name: lm_head.bias, Shape: [33]
Name: lm_head.dense.bias, Shape: [320]
Name: lm_head.dense.weight, Shape: [320, 320]
Name: lm_head.layer_norm.bias, Shape: [320]
Name: lm_head.layer_norm.weight, Shape: [320]
```
